\documentclass[usenames,dvipsnames]{beamer}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{csquotes}
\usepackage{tabularx,pbox}
% tikz packages
\usetikzlibrary{positioning}
\usepackage{physics}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage{gensymb}
\usepackage{tabularx}
\usepackage{extarrows}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}


\definecolor{carminepink}{rgb}{0.92, 0.3, 0.26}
\definecolor{candypink}{rgb}{0.89, 0.44, 0.48}

% theme
\usetheme[numbering=counter, progressbar=foot, titleformat=allcaps]{metropolis}  
\setbeamercolor{title separator}{fg=BrickRed}
\setbeamercolor{progress bar in head/foot}{fg=BrickRed}
\setbeamercolor{alerted text}{fg=BrickRed}

\newcommand{\tabitem}{~~\llap{\textbullet}~~}

\title{Markov Chain Analysis of \\The Ehrenfest Urn Model}
\date{2020/2021}
\author{Elena Acinapura}
\institute{UniversitÃ  di Trento}

\begin{document}
  \maketitle

  \begin{frame}{Contents}
    \MakeUppercase{\textbf{The Ehrenfest urn model}}

    \bigskip
    \MakeUppercase{\textbf{Analysis via Markov chains}}
      \begin{itemize}
        \item Limiting distribution
        \item Mean recurrence time
      \end{itemize}
      \bigskip
    \MakeUppercase{\textbf{Simulation}}
  \end{frame}

  \section{Motivation}
  \begin{frame}{Irreversibility vs Recurrence}
    \begin{center}
      Thermodynamic processes such as
    \end{center}
    \begin{table}
        \begin{center}
        \begin{tabular}{l c}
            \tabitem diffusions & \\
            \tabitem heat transfers & $\rightarrow \quad $ \alert{\MakeUppercase{irreversible}}\\
            \tabitem phase transitions & 
        \end{tabular}
        \end{center}
    \end{table}
    
    \begin{center}
        \textbf{but}
    \end{center}
    
    \begin{center}
    Newtonian mechanics $\quad \rightarrow \quad$ \alert{\MakeUppercase{time-reversible}}
    \end{center}
  \end{frame}

  \begin{frame}[standout]
    \textsc{A statistical approach}
  \end{frame}
  

  \section{The Ehrenfest Urn Model}
  \input{model}

  
  \section{Markov chain analysis}
  \begin{frame}{Markov chains - definitions}
    \begin{center}
      \Large{\textbf{Discrete Markov chains}}
    \end{center}
    A mathematical theory for stochastic processes

    The state of the system $X$ is a random variable

    \bigskip
    \begin{figure}
      \input{pictures/statespace}
    \end{figure}
  \end{frame}

  \begin{frame}{Markov chains - definitions}
    \begin{center}
      \Large{\textbf{Markov property}}
    \end{center}
    \begin{table}
      \begin{tabularx}{\textwidth}{c >{\raggedright}X}
        \alert{\emph{Memorylessness}}: & only the current state influences the next transition \tabularnewline
      \end{tabularx}
    \end{table}
  \end{frame}

  \begin{frame}{Markov chains --- definitions}
    \begin{center}
      \Large \textbf{Representing probabilities}
    \end{center}

    \renewcommand{\tabularxcolumn}{m}
    \begin{table}
      \begin{tabularx}{0.9\textwidth}{c c >{\raggedright}X}
        \alert{Distribution} & $\rightarrow$ & probabilities for the system to be in the various possible states \tabularnewline
        & & \tabularnewline
        \alert{Stochastic matrix} & $\rightarrow$ & probabilities of the possible transitions
      \end{tabularx}

    \end{table}
    
  \end{frame}

  \begin{frame}{Markov chains and the Ehrenfest model}
    \Large In the Ehrenfest model:
    \normalsize
    \begin{itemize}
      \item<1-> state $X = $ number of particles in box A
      \item<2-> possible values: $0, \dots, N$
      \item<3-> example
    \end{itemize}
    
    \begin{figure}[r]
      \only<3>{\input{pictures/example_state}}
    \end{figure}
  \end{frame}

  \begin{frame}[standout]
    \textsc{A sequence of states of the Ehrenfest model is a Markov chain}\\
    \vspace{30pt}
    \textsc{The \enquote{Ehrenfest chain}}
  \end{frame}


  \section{Asymptotic behaviour}
  \begin{frame}{LIMITING DISTRIBUTION}
    \centering
    Evolution for $t$ time steps\\\medskip
    $\downarrow$\\\medskip
    Does the distribution converge as $t \rightarrow \infty$?\\\medskip
    $\downarrow$\\\medskip
    \alert{Limiting distribution}\\\medskip
    $\downarrow$\\\medskip
    Concept of \alert{equilibrium}
  \end{frame}

  \begin{frame}{STATIONARY DISTRIBUTION}
    \centering
    \Large \textbf{Stationary distribution}
    \normalsize
    \begin{itemize}
      \item distribution that \alert{remains the same} after one timestep
      \item \alert{eigenvector} of the stochastic matrix with unitary eigenvalue
    \end{itemize}
  \end{frame}

  \begin{frame}[standout]
    \textsc{The limiting distribution is a stationary distribution}
  \end{frame}

  \begin{frame}
    \Large
    \centering
    \dots\ \textsc{however, a stationary distribution is not always the limiting distribution}
    
    \vspace{40pt}

    \normalsize
    The \alert{Perron-Frobenius theorem} gives the sufficient conditions
  \end{frame}

  \begin{frame}{Asymptotic limit of the Ehrenfest chain}
    \Large 
    \centering
    \vspace{30pt}
    Limiting distribution of the Ehrenfest chain\\
    \vspace{20pt}
    \MakeUppercase{\alert{Binomial distribution}}\\
  \end{frame}
  
  \begin{frame}{Asymptotic limit of the Ehrenfest chain}
    \vspace{30pt}
    Example with $N = 10$
    \begin{figure}
      \includegraphics[scale = 0.5]{pictures/binomial.pdf}
    \end{figure}
  \end{frame}

\end{document}